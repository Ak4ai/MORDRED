<!DOCTYPE html>
    <html lang="en">
    <head>
        <link rel="icon" type="image/png" href="android-icon-192x192.png">
        <link rel="stylesheet" href="style.css?v=1.0.6">
        <meta charset="UTF-8">
        <meta name="viewport" content="width=device-width, initial-scale=1, viewport-fit=cover">
        <title>MORDRED-Nexus</title>
        <meta name="theme-color" content="#29243e"> <!-- Android -->
        <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent"> <!-- iOS -->
        <style>
            body {
                font-family: 'Open Sans', sans-serif;
            }
        </style>
        <meta http-equiv="Content-Security-Policy" content="
        default-src 'self';
        script-src 
          'self' 
          'unsafe-inline' 
          'unsafe-eval' 
          blob: 
          data: 
          https://apis.google.com 
          https://www.gstatic.com 
          https://accounts.google.com 
          https://cdn.jsdelivr.net 
          https://unpkg.com 
          https://www.youtube.com;
        style-src 
          'self' 
          'unsafe-inline' 
          https://cdnjs.cloudflare.com;
        font-src 
          'self' 
          https://cdnjs.cloudflare.com;
        connect-src 
          'self' 
          https://www.googleapis.com 
          https://accounts.google.com 
          https://oauth2.googleapis.com 
          ws://127.0.0.1:5501 
          https://backmordred.vercel.app 
          https://apis.google.com 
          https://www.google.com 
          https://firestore.googleapis.com 
          https://www.youtube.com 
          https://postimages.org 
          https://postimage.me;
    
        img-src 
          'self' 
          https://i.pinimg.com 
          https://csi.gstatic.com 
          https://lh3.googleusercontent.com 
          https://media.discordapp.net 
          https://i.ytimg.com 
          https://via.placeholder.com 
          https://preview.redd.it 
          https://external-preview.redd.it 
          https://redditmedia.com 
          https://i.imgur.com 
          https://i.postimg.cc 
          https://static.wikia.nocookie.net
          data:;
        frame-src 
          https://accounts.google.com 
          https://content.googleapis.com 
          https://content-people.googleapis.com 
          https://www.youtube.com 
          https://www.youtube-nocookie.com;
      ">

        <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css">

        <!-- Firebase App -->
        <script type="module">
            import { initializeApp } from "https://www.gstatic.com/firebasejs/10.8.0/firebase-app.js";
            // e continue seu c√≥digo aqui
        </script>
        <!-- Firestore -->
        <script type="module">
            import { initializeApp } from "https://www.gstatic.com/firebasejs/9.22.0/firebase-app.js";
            import {
              getFirestore, doc, setDoc, updateDoc, onSnapshot
            } from "https://www.gstatic.com/firebasejs/9.22.0/firebase-firestore.js";        </script>
        <!-- Firebase Archive -->
        <script src="https://www.gstatic.com/firebasejs/10.8.0/firebase-app-compat.js"></script>
        <script src="https://www.gstatic.com/firebasejs/10.8.0/firebase-firestore-compat.js"></script>
        
        <script>
          const firebaseConfig = {
            apiKey: "AIzaSyBTqNSXSGTD0uA7GtjdF-6oQsETq61YgUs",
            authDomain: "mordred-f7ea1.firebaseapp.com",
            projectId: "mordred-f7ea1",
            storageBucket: "mordred-f7ea1.firebasestorage.app",
            messagingSenderId: "248130349710",
            appId: "1:248130349710:web:b2b3b0af3528627de7f7df",
            measurementId: "G-GC5Z4S28R2"
          };
        
          const app = firebase.initializeApp(firebaseConfig);
          const db = firebase.firestore();
          const videoDocRef = db.collection("sync").doc("videoStatus"); // Compat√≠vel com compat
          console.log("Firebase (compat) carregado com sucesso!");
          
        </script>
        <script src="https://www.youtube.com/iframe_api"></script>
        <!-- Math.js -->
        <script src="https://unpkg.com/mathjs@11.8.2/lib/browser/math.js"></script>

        <!-- Random.js -->
        <script src="https://cdn.jsdelivr.net/npm/random-js@2.1.0/dist/random-js.umd.min.js"></script>

        <!-- RPG Dice Roller (vers√£o UMD) -->
        <script src="https://cdn.jsdelivr.net/npm/@dice-roller/rpg-dice-roller@5.5.1/lib/umd/bundle.min.js"></script>

        <!-- Seu script do chat -->
        <script src="./chat.js"></script>
    </head>
  <body>
    <script>
      if ('serviceWorker' in navigator) {
        window.addEventListener('load', function() {
          navigator.serviceWorker.register('/service-worker.js').then(function(registration) {
            console.log('ServiceWorker registration successful with scope: ', registration.scope);
          }, function(error) {
            console.log('ServiceWorker registration failed: ', error);
          });
        });
      }
    </script>
    <div id="blur-background"></div>
    <div id="popup-alert">
        <span id="popup-alert-text"></span>
    </div>  
    <div id="custom-dialog" class="dialog-container" style="display: none;">
        <div class="dialog-message" id="dialog-message"></div>
        <div class="dialog-buttons">
            <button id="dialog-ok-button">OK</button>
        </div>
    </div>
    <div id="iniciativa-container">
      <div style="display: flex; align-items: center; justify-content: space-between;">
        <h3 style="margin: 0;">Iniciativas</h3>
        <div>
          <button 
            id="btn-organizar-iniciativas" 
            onclick="organizarIniciativas()" 
            style="margin-left: 10px;"
            title="Organizar Iniciativas"
          >üîù</button>
          <button 
            id="btn-limpar-iniciativas" 
            onclick="limparIniciativas()" 
            style="display: none; margin-left: 10px;"
          >üßπ</button>
        </div>
      </div>
    
      <ul id="lista-iniciativas"></ul>
    
      <div id="manual-entry">
        <input type="text" id="nome-manual" placeholder="Nome" />
        <input type="number" id="valor-manual" placeholder="Valor" />
        <button onclick="adicionarIniciativaManual()">‚ûï</button>
        </div>
    </div>
    <div id="pull-up-indicator"></div>
    <div id="black-overlay"></div>
    <div id="mapa-container">
        <div id="tabuleiro-wrapper">
            <div id="tabuleiro-inner">
                <div id="tabuleiro-bg"></div> <!-- A imagem de fundo vem ANTES da grid -->
                <div id="tabuleiro"></div> <!-- Apenas a grid -->
                <div id="token-layer"></div> <!-- Tokens ficam aqui -->
            </div>
        </div>
    </div>      
    <button id="togglecontainer"class="toggle-container"><i class="fa-solid fa-arrows-to-eye"></i></button>
    <!-- Container da barra de fichas -->
    <div id="barra-fichas"></div>
    <div id="zoom-controls">
        <button id="zoom-in"><i class="fa-solid fa-plus"></i></button>
        <button id="zoom-out"><i class="fa-solid fa-minus"></i></button>
    </div> 
    <button id="toggle-bg-interaction"><i class="fa-solid fa-map-location-dot"></i></button>     
    <button id="toggle-barreira-opacity"><i class="fa-solid fa-xmarks-lines"></i></button>
    <div class="player-container">
        <div id="togglevideoPlayer" class="togglevideo-button"><i class="fa-solid fa-chevron-down"></i></div>
    
        <!-- Novo agrupamento -->
        <div class="link-and-button">
            <input type="text" id="youtubeLink" placeholder="Cole o link do YouTube aqui" />
            <button id="loadVideo"><i class="fa-solid fa-magnifying-glass"></i></button>
        </div>
    
        <div id="youtubePlayer"></div>
    
        <!-- Controles -->
        <div id="controls">
            <button id="playPauseButton"><i class="fa-solid fa-play"></i></button>
            <button id="unskipButton"><i class="fa-solid fa-backward-step"></i></button>
            <button id="skipButton"><i class="fa-solid fa-forward-step"></i></button>
        </div>
        <div id="videoQueueDisplay" class="queue-container">
            <h4>Fila de V√≠deos:</h4>
            <ul id="videoQueueList"></ul>
        </div>          
        <div id="volumeContainer">
            <input type="range" id="volumeControl" min="0" max="100" step="1" value="0" />
        </div>
    </div>    
    <div id="chat-container">
        <div id="chat-mensagens"></div>
        <div id="chat-input-container">
            <input type="text" id="chat-input" placeholder="Digite sua mensagem...">
            <button id="chat-enviar"><i class="fa-solid fa-play"></i></button>
        </div>
    </div>      
    <div id="essential-info" class="hidden">
        <div class="top-section">
          <img id="status-img" alt="Essential Info Image">
          <img id="status-token" alt="Essentia Info Token">
          <div class="text-section">
            <h2 id="status-nome"></h2>
          </div>
        </div>
      
        <div class="status-item">
          <div class="status-label">
            <label>Vida:</label>
            <span id="status-vida1">0 / 100</span>
          </div>
          <div class="status-bar">
            <div class="status-bar-fill" id="status-bar-vida1" style="width: 0%;"></div>
          </div>
        </div>
        <div class="status-item">
          <div class="status-label">
            <label>Energia:</label>
            <span id="status-energia1">0 / 100</span>
          </div>
          <div class="status-bar">
            <div class="status-bar-fill" id="status-bar-energia1" style="width: 0%;"></div>
          </div>
        </div>
        <div class="status-item">
          <div class="status-label">
            <label>Sanidade:</label>
            <span id="status-sanidade1">0 / 100</span>
          </div>
          <div class="status-bar">
            <div class="status-bar-fill" id="status-bar-sanidade1" style="width: 0%;"></div>
          </div>
        </div>
    </div>         
    <div id="essential-info2" class="hidden">
        <h3>Anota√ß√µes:</h3>
        <div class="textarea-wrapper">
          <textarea id="anotacoes" placeholder="Escreva suas anota√ß√µes aqui..." onchange="salvarAnotacoes()"></textarea>
        </div>
    </div>         
    <div id="deviceready" class="blink"></div>
    <div class="container">
        <button id="togglecontainer1"class="toggle-container"><i class="fa-solid fa-arrows-to-eye"></i></button>

        <div class="tabs">
            <div class="tab active" onclick="openTab('info')">Info</div>
            <div class="tab" onclick="openTab('skills')">Skills</div>
            <div class="tab" onclick="openTab('actions')">Actions</div>
            <div class="tab" onclick="openTab('inventory')">Inventory</div>
            <div class="tab" onclick="openTab('config')">Config</div>
        </div>  
        
        <div id="info" class="content active">
            <h1>Status do Personagem</h1>
            <div class="status-info">
                <div class="status-column">
                  <h2>Status Base</h2>
                  <div class="status-item">
                      <div class="status-label">
                          <label>Vida:</label>
                          <span id="status-vida">0 / 100</span>
                      </div>
                      <div class="status-bar">
                          <div class="status-bar-fill" id="status-bar-vida" style="width: 0%;"></div>
                      </div>
                  </div>
                  <div class="status-item">
                      <div class="status-label">
                          <label>Energia:</label>
                          <span id="status-energia">0 / 100</span>
                      </div>
                      <div class="status-bar">
                          <div class="status-bar-fill" id="status-bar-energia" style="width: 0%;"></div>
                      </div>
                  </div>
                  <div class="status-item">
                      <div class="status-label">
                          <label>Sanidade:</label>
                          <span id="status-sanidade">0 / 100</span>
                      </div>
                      <div class="status-bar">
                          <div class="status-bar-fill" id="status-bar-sanidade" style="width: 0%;"></div>
                      </div>
                  </div>
                </div>
                <div class="status-column3">
                  <h2>Atributos</h2>
                  <div class="atributos-grid">
                    <div class="atributo-item" style="display: none;">
                      <label for="atbrnull">Nulo:</label>
                      <span id="status-atbrnull">0</span>
                    </div>
                    <div class="atributo-item">
                      <label for="atbr1"></label>
                      <span id="status-atbr1"></span>
                    </div>
                    <div class="atributo-item">
                      <label for="atbr2"></label>
                      <span id="status-atbr2"></span>
                    </div>
                    <div class="atributo-item">
                      <label for="atbr3"></label>
                      <span id="status-atbr3"></span>
                    </div>
                  </div>    </div>
            </div>
            <div class="status-pericias">
              <h2 class="collapsible" onclick="togglePericias()">Per√≠cias</h2>
              <div class="status-info2 content-collapsed" id="pericias-content">

                <!-- Coluna 1 -->
                <div class="status-column2">
                  <div class="status-item" style="display: none;">
                    <label>Null:</label>
                    <span id="status-pericia-null">0</span>
                  </div>
                  <div class="status-item">
                    <label>Reflexo:</label>
                    <span id="status-pericia-reflexo">0</span>
                    <p>Descri√ß√£o da per√≠cia Reflexo.</p>
                  </div>
                  <div class="status-item">
                    <label>Medicina:</label>
                    <span id="status-pericia-medicina">0</span>
                    <p>Descri√ß√£o da per√≠cia Medicina.</p>
                  </div>
                  <div class="status-item">
                    <label>Manifesta√ß√£o:</label>
                    <span id="status-pericia-manifestacao">0</span>
                    <p>Descri√ß√£o da per√≠cia Manifesta√ß√£o.</p>
                  </div>
                  <div class="status-item">
                    <label>Fortitude:</label>
                    <span id="status-pericia-fortitude">0</span>
                    <p>Descri√ß√£o da per√≠cia Fortitude.</p>
                  </div>
                  <div class="status-item">
                    <label>Luta:</label>
                    <span id="status-pericia-luta">0</span>
                    <p>Descri√ß√£o da per√≠cia Luta.</p>
                  </div>
                  <div class="status-item">
                    <label>Vontade:</label>
                    <span id="status-pericia-vontade">0</span>
                    <p>Descri√ß√£o da per√≠cia Vontade.</p>
                  </div>
                  <div class="status-item">
                    <label>Pontaria:</label>
                    <span id="status-pericia-pontaria">0</span>
                    <p>Descri√ß√£o da per√≠cia Pontaria.</p>
                  </div>
                  <div class="status-item">
                    <label>Calamidade:</label>
                    <span id="status-pericia-calamidade">0</span>
                    <p>Descri√ß√£o da per√≠cia Calamidade.</p>
                  </div>
                </div>

                <!-- Coluna 2 -->
                <div class="status-column2">
                  <div class="status-item">
                    <label>Percep√ß√£o:</label>
                    <span id="status-pericia-percepcao">0</span>
                    <p>Descri√ß√£o da per√≠cia Percep√ß√£o.</p>
                  </div>
                  <div class="status-item">
                    <label>Investiga√ß√£o:</label>
                    <span id="status-pericia-investigacao">0</span>
                    <p>Descri√ß√£o da per√≠cia Investiga√ß√£o.</p>
                  </div>
                  <div class="status-item">
                    <label>Sorte:</label>
                    <span id="status-pericia-sorte">0</span>
                    <p>Descri√ß√£o da per√≠cia Sorte.</p>
                  </div>
                  <div class="status-item">
                    <label>Furtividade:</label>
                    <span id="status-pericia-furtividade">0</span>
                    <p>Descri√ß√£o da per√≠cia Furtividade.</p>
                  </div>
                  <div class="status-item">
                    <label>Intelig√™ncia:</label>
                    <span id="status-pericia-inteligencia">0</span>
                    <p>Descri√ß√£o da per√≠cia Intelig√™ncia.</p>
                  </div>
                  <div class="status-item">
                    <label>Diplomacia:</label>
                    <span id="status-pericia-diplomacia">0</span>
                    <p>Descri√ß√£o da per√≠cia Diplomacia.</p>
                  </div>
                  <div class="status-item">
                    <label>Pilotagem:</label>
                    <span id="status-pericia-pilotagem">0</span>
                    <p>Descri√ß√£o da per√≠cia Pilotagem.</p>
                  </div>
                  <div class="status-item">
                    <label>Iniciativa:</label>
                    <span id="status-pericia-iniciativa">0</span>
                    <p>Exclusiva para iniciativa.</p>
                  </div>
                </div>
              </div>
            </div>   
            <div class="status-tracos">
                <h2 class="collapsible" onclick="toggleTracos()">Tra√ßos</h2>
                  <div class="status-info2 content-collapsed" id="tracos-content">
                    <div class="status-column2">
                          <div class="status-item">
                              <label>Raiz:</label>
                              <span id="status-traco-raiz"></span>
                          </div>
                          <div class="status-item">
                              <label>Subraiz:</label>
                              <span id="status-traco-subraiz"></span>
                          </div>
                          <div class="status-item">
                              <label>Defeitos:</label>
                              <span id="status-traco-defeitos"></span>
                          </div>
                          <div class="status-item">
                              <label>Efeitos:</label>
                              <span id="status-traco-efeitos"></span>
                          </div>
                      </div>
                      <div class="status-column2">
                          <div class="status-item">
                              <label>Corpo:</label>
                              <span id="status-traco-corpo"></span>
                          </div>
                          <div class="status-item">
                              <label>Peso:</label>
                              <span id="status-traco-peso"></span>
                          </div>
                            <div class="status-item">
                                <label>Ra√ßa:</label>
                                <span id="status-traco-raca"></span>
                            </div>
                            <div class="status-item">
                                <label>Cultura:</label>
                                <span id="status-traco-cultura"></span>
                            </div>
                        </div>
                        <div class="status-column4">
                            
                            <label>Hist√≥ria:</label><br><br>
                            <div class="status-item">
                                <span id="status-traco-historia"></span>
                            </div>
                        </div>
                  </div>
              </div>
            </div>
        <!-- Skills Section with Subtabs -->
        <div id="skills" class="content">
            <div class="subtabs">
                <div class="subtab active" onclick="openSubtab('skills', 'habilidades')">Habilidades</div>
                <div class="subtab" onclick="openSubtab('skills', 'escolha')">Escolha</div>
            </div>
            <div id="escolha" class="subcontent">
                <h2>Escolha uma habilidade:</h2>
                <div id="escolha-habilidades">
                </div>
            </div>
            <div id="habilidades" class="subcontent active">
                <h2 id="habilidade-nome"></h2>
                <p id="habilidade-descricao"></p>
                <div id="botoes-habilidade">
                    <button id="usar-habilidade" onclick="usarHabilidade()">Usar Habilidade</button>
                    <button onclick="sair()">Sair</button>
                </div>
                <div id="dano-total"></div>
                <div id="teste-habilidade"></div>
                <br>
                <div id="status">
                    <!-- Aqui ser√° inserido o status dinamicamente -->
                </div>
                <p id="texto-nenhuma-habilidade" style="display: none;">Escolha uma habilidade na aba Escolha</p>
            </div>                
        </div>

        <div id="config" class="content">
            <div class="subtabs">
                <div class="subtab active" onclick="openSubtab('config', 'status1')">Status</div>
                <div class="subtab" onclick="openSubtab('config', 'habilidades1')">Skills</div>
                <div class="subtab" onclick="openSubtab('config', 'habilidades2')">SaveData</div>
                <div class="subtab" onclick="openSubtab('config', 'Google')">Google</div>
            </div>
            <div id="status1" class="subcontent active">
                <div id="toggle-atualizar">
                    <label class="switch">
                        <input type="checkbox" id="atualizar-checkbox">
                        <span class="slider round"></span>
                    </label>
                    <span class="toggle-label">Atualizar</span>
                </div>
                <h2>Atualizar Status</h2>
                <form id="status-form">

                <!-- Identifica√ß√£o -->
                <fieldset>
                    <legend>Identifica√ß√£o</legend>
                    <label for="nome">Nome do Personagem:</label>
                    <input type="text" id="nome" name="nome" required><br>

                    <label for="img">Imagem do Personagem:</label>
                    <input type="text" id="img" name="imagem" required><br>

                    <label for="token">Token do Personagem:</label>
                    <input type="text" id="token" name="token" required>
                </fieldset>
                <br>
                <div id="upload">
                  <label for="uploadImage">Upload Imagem:</label>
                  <button 
                    type="button" 
                    id="uploadImage"
                    onclick="window.open(
                      'https://postimages.org/upload',
                      'PostImages',
                      'width=800,height=600,top=100,left=100,resizable=yes,scrollbars=yes'
                    )"
                  >
                    Ir para PostImages
                  </button>
                </div>
                <!-- Atributos -->
                <fieldset>
                    <legend>Atributos</legend>
                    <label for="vida">Vida:</label>
                    <input type="number" id="vida" name="vida" min="0">

                    <label for="vidaMax">Vida Max:</label>
                    <input type="number" id="vidaMax" name="vidaMax" min="0"><br>

                    <label for="energia">Energia:</label>
                    <input type="number" id="energia" name="energia" min="0">

                    <label for="energiaMax">Energia Max:</label>
                    <input type="number" id="energiaMax" name="energiaMax" min="0"><br>

                    <label for="sanidade">Sanidade:</label>
                    <input type="number" id="sanidade" name="sanidade" min="0"><br>

                    <label for="sanidadeMax">Sanidade Max:</label>
                    <input type="number" id="sanidadeMax" name="sanidadeMax" min="0">
                </fieldset>

                <!-- Atributos Base -->
                <fieldset id="atributos-base">
                  <legend>Atributos Base</legend>

                  <label for="atbr1"></label>
                  <input type="number" id="atbr1" name="atbr1" min="0"><br>

                  <label for="atbr2"></label>
                  <input type="number" id="atbr2" name="atbr2" min="0"><br>

                  <label for="atbr3"></label>
                  <input type="number" id="atbr3" name="atbr3" min="0"><br>
                </fieldset>

                <fieldset>
                  <legend>Per√≠cias</legend>

                  <label for="reflexo">Reflexo:</label>
                  <input type="number" id="reflexo" name="reflexo" min="0"><br>

                  <label for="medicina">Medicina:</label>
                  <input type="number" id="medicina" name="medicina" min="0"><br>

                  <label for="manifestacao">Manifesta√ß√£o:</label>
                  <input type="number" id="manifestacao" name="manifestacao" min="0"><br>

                  <label for="fortitude">Fortitude:</label>
                  <input type="number" id="fortitude" name="fortitude" min="0"><br>

                  <label for="luta">Luta:</label>
                  <input type="number" id="luta" name="luta" min="0"><br>

                  <label for="vontade">Vontade:</label>
                  <input type="number" id="vontade" name="vontade" min="0"><br>

                  <label for="pontaria">Pontaria:</label>
                  <input type="number" id="pontaria" name="pontaria" min="0"><br>

                  <label for="calamidade">Calamidade:</label>
                  <input type="number" id="calamidade" name="calamidade" min="0"><br>

                  <label for="percepcao">Percep√ß√£o:</label>
                  <input type="number" id="percepcao" name="percepcao" min="0"><br>

                  <label for="investigacao">Investiga√ß√£o:</label>
                  <input type="number" id="investigacao" name="investigacao" min="0"><br>

                  <label for="sorte">Sorte:</label>
                  <input type="number" id="sorte" name="sorte" min="0"><br>

                  <label for="furtividade">Furtividade:</label>
                  <input type="number" id="furtividade" name="furtividade" min="0"><br>

                  <label for="inteligencia">Intelig√™ncia:</label>
                  <input type="number" id="inteligencia" name="inteligencia" min="0"><br>

                  <label for="diplomacia">Diplomacia:</label>
                  <input type="number" id="diplomacia" name="diplomacia" min="0"><br>

                  <label for="pilotagem">Pilotagem:</label>
                  <input type="number" id="pilotagem" name="pilotagem" min="0">

                  <label for="iniciativa">Iniciativa:</label>
                  <input type="number" id="iniciativa" name="iniciativa" min="0"><br>
                </fieldset>


                <!-- Tra√ßos -->
                <fieldset>
                    <legend>Tra√ßos</legend>
                    <label for="tracoRaiz">Tra√ßo Raiz:</label>
                    <input type="text" id="tracoRaiz" name="tracoRaiz"><br>

                    <label for="tracoSubraiz">Tra√ßo Subraiz:</label>
                    <input type="text" id="tracoSubraiz" name="tracoSubraiz"><br>

                    <label for="tracoRaca">Tra√ßo Ra√ßa:</label>
                    <input type="text" id="tracoRaca" name="tracoRaca"><br>

                    <label for="tracoCultura">Tra√ßo Cultura:</label>
                    <input type="text" id="tracoCultura" name="tracoCultura"><br>

                    <label for="tracoCorpo">Tra√ßo Corpo:</label>
                    <input type="text" id="tracoCorpo" name="tracoCorpo"><br>

                    <label for="tracoDefeitos">Tra√ßo Defeitos:</label>
                    <input type="text" id="tracoDefeitos" name="tracoDefeitos"><br>

                    <label for="tracoEfeitos">Tra√ßo Efeitos:</label>
                    <input type="text" id="tracoEfeitos" name="tracoEfeitos"><br>

                    <label for="tracoPeso">Tra√ßo Peso:</label>
                    <input type="text" id="tracoPeso" name="tracoPeso"><br>

                    <label for="tracoHistoria">Tra√ßo Hist√≥ria:</label>
                    <textarea id="tracoHistoria" name="tracoHistoria"></textarea>
                </fieldset>

                <!-- Inicializa√ß√£o -->
                <fieldset>
                    <legend>Inicializa√ß√£o</legend>
                    <label for="personagemInicial">Personagem de Inicializa√ß√£o:</label>
                    <input type="checkbox" id="personagemInicial" name="personagemInicial">
                </fieldset>

                <br>
                <button type="button" onclick="salvarStatus()">Salvar</button>
                </form>

                <h2>Carregar Status</h2>
                <label for="nomeCarregar">Nome do Personagem:</label>
                <input type="text" id="nomeCarregar" name="nomeCarregar" required>
                <br>
                <button type="button" onclick="carregarStatus()">Carregar</button>
                <h2>Listar Arquivos</h2>
                <button type="button" onclick="listarArquivos()">Listar Arquivos Salvos</button>
            </div>
            <div id="habilidades1" class="subcontent">
                <h2>Carregar Habilidades</h2>
                <div id="toggle-atualizar">
                    <label class="switch">
                        <input type="checkbox" id="atualizarhabilidade-checkbox">
                        <span class="slider round"></span>
                    </label>
                    <span class="toggle-label">Atualizar</span>
                </div>
                <label for="nomeCarregarHab">Nome do Personagem:</label>
                <input type="text" id="nomeCarregarHab" name="nomeCarregarHab" required>
                <br>
                <label for="nomeHabilidade">Nome da Habilidade:</label>
                <input type="text" id="nomeHabilidade" name="nomeHabilidade" required>
                <br>
            
                <label for="testeHabilidade">Teste de Habilidade:</label>
                <div class="teste-habilidade-container">
                    <div id="toggle-atualizar">
                        <input type="checkbox" id="toggleHabilidade">
                    </div>
            
                    <select id="atributoSelect">
                        <option value="atbrnull">Null</option>
                        <option value="atbr1"></option>
                        <option value="atbr2"></option>
                        <option value="atbr3"></option>
                        <!-- Adicione mais op√ß√µes conforme necess√°rio -->
                    </select>
            
                    <select id="periciaSelect">
                      <option value="null">Null</option>
                      <option value="reflexo">Reflexo</option>
                      <option value="medicina">Medicina</option>
                      <option value="manifestacao">Manifesta√ß√£o</option>
                      <option value="fortitude">Fortitude</option>
                      <option value="luta">Luta</option>
                      <option value="vontade">Vontade</option>
                      <option value="pontaria">Pontaria</option>
                      <option value="calamidade">Calamidade</option>
                      <option value="percepcao">Percep√ß√£o</option>
                      <option value="investigacao">Investiga√ß√£o</option>
                      <option value="sorte">Sorte</option>
                      <option value="furtividade">Furtividade</option>
                      <option value="inteligencia">Intelig√™ncia</option>
                      <option value="diplomacia">Diplomacia</option>
                      <option value="pilotagem">Pilotagem</option>
                      <option value="iniciativa">Iniciativa</option>
                    </select>
                
            
                    <input type="number" id="vantagensInput" placeholder="Vantagens">
                    <input type="number" id="modificadorInput" placeholder="Modificador">
                </div>
            
                <br>
                <label for="danoHabilidade">Dano:</label>
                <input type="text" id="danoHabilidade" name="danoHabilidade" required>
                <br>
                <label for="cooldownHabilidade">Cooldown:</label>
                <input type="number" id="cooldownHabilidade" name="cooldownHabilidade" required>
                <br>
                <label for="custoHabilidade">Custo:</label>
                <input type="text" id="custoHabilidade" name="custoHabilidade" required>
                <br>
                <label for="custoVida">Custo Vida:</label>
                <input type="text" id="custoVidaHabilidade" name="custoVida" required>
                <br>
                <label for="descricaoHabilidade">Descri√ß√£o:</label>
                <textarea id="descricaoHabilidade" name="descricaoHabilidade" required></textarea>
                <br>
                <button type="button" onclick="carregarHabilidades2()">Carregar Habilidade</button>
            
                <!-- Nova se√ß√£o para remover habilidade -->
                <div id="removerHabilidadeContainer" style="margin-top:20px; padding-top:10px; border-top:1px solid #ccc;">
                    <h3>Remover Habilidade</h3>
                    <label for="nomeRemoverHab">Nome do Personagem:</label>
                    <input type="text" id="nomeRemoverHab" name="nomeRemoverHab" required>
                    <br>
                    <label for="nomeRemoverHabilidade">Nome da Habilidade:</label>
                    <input type="text" id="nomeRemoverHabilidade" name="nomeRemoverHabilidade" required>
                    <br>
                    <button type="button" onclick="removerHabilidade()">Remover Habilidade</button>
                </div>
            </div>
            <div id="habilidades2" class="subcontent">
                <h2>Exportar e Importar Data</h2>
                <br>
                <input type="text" id="nomeArquivoExportar" placeholder="Nome do arquivo para exportar">
                <button type="button" onclick="exportarArquivo()">Exportar Arquivo</button>
                <br><br>
                <input type="file" id="inputArquivoImportar">
                <button type="button" onclick="importarArquivo()">Importar Arquivo</button>
                <br><br>
                <input type="text" id="nomeArquivoRemover" placeholder="Nome do arquivo para remover">
                <button type="button" onclick="removerArquivo()">Remover Arquivo</button>
                <br><br>
                <button type="button" onclick="listarArquivos()">Listar Arquivos no LocalStorage</button>
                <br>
                <hr>
                <h2>Atualizar Site</h2>
                Aperte esse bot√£o para atualizar o site e carregar os dados mais recentes.<br>
                Aviso: ele vai apagar seus dados entao tenha certeza de fazer um backup antes.<br>
                <br>
                <button id="clear-data-btn">Apagar Dados e Recarregar</button>
                <hr><br>
                <!-- Se√ß√£o para ativar/desativar modo Admin -->
                <h2>Modo Administrador</h2>
                <input type="password" id="senhaAdmin" placeholder="Digite a senha de admin">
                <button type="button" onclick="ativarAdmin()">Ativar Admin</button>
                <button type="button" onclick="desativarAdmin()">Desativar Admin</button>
                <p id="adminStatus" style="color: green;"></p>
                <div id="set-nomes-atributos" style="display:none; margin-top:20px; border:1px solid #aaa; padding:10px;">
                  <h3>Setar Nomes dos Atributos</h3>
                  <input type="text" id="atributo-nome-1" placeholder="Nome do Atributo 1">
                  <input type="text" id="atributo-nome-2" placeholder="Nome do Atributo 2">
                  <input type="text" id="atributo-nome-3" placeholder="Nome do Atributo 3">
                  <button type="button" onclick="setarNomesAtributos()">Salvar Nomes</button>
                  <span id="status-set-nomes" style="margin-left:10px;"></span>
                </div>
            </div>  
            <div id="Google" class="subcontent">
                <div class="title">Backup To Google Drive</div>

                <div id="loader" class="loader-overlay">
                    <div class="loader"></div>
                </div>                
                
                <!-- Bot√µes de autentica√ß√£o -->
                <div class="auth-buttons">
                    <button class="signin">Sign In</button>
                    <button class="signout" style="display: none;">Sign Out</button>
                </div>
                
                <!-- Adicionado: exibi√ß√£o do nome e imagem do usu√°rio -->
                <div class="user-info" style="display: none; margin-top: 10px;">
                    <img src="" alt="User Icon" class="user-icon" style="width: 32px; height: 32px; border-radius: 50%; margin-right: 5px;">
                    <span class="user-name"></span>
                </div>
            
                <!-- Bot√£o de sincroniza√ß√£o separado -->
                <div class="sync-container">
                    <button class="sync">Sync</button>
                    <button class="restore">Restaurar backup</button>
                </div>
                <p class="last-sync" style="display: none; margin-top: 10px; font-size: 14px; color: #555;"></p>
            </div>                                                                                                                           
        </div>            
            
        <!-- Se√ß√£o de Invent√°rio -->
        <div id="inventory" class="content">
            <h2>Invent√°rio</h2>
            <div id="inventory-items">
            <!-- Os itens ser√£o adicionados dinamicamente aqui -->
            </div>
            <button id="open-add-item">Adicionar Item</button>
            <div id="total-weight"></div>
        </div>
        
        <!-- Modal para adicionar novo item -->
        <div id="add-item-modal" class="modal" style="display: none;">
            <div class="modal-content">
            <h3>Adicionar Novo Item</h3>
            
            <label for="item-name">Nome:</label>
            <input type="text" id="item-name" placeholder="Nome do item">
            
            <fieldset>
              
              <legend>Icon</legend>
              <div id="uploadmodal">
                <label for="uploadImage">Upload Imagem:</label>
                <button 
                  type="button" 
                  id="uploadImage"
                  onclick="window.open(
                    'https://postimages.org/upload',
                    'PostImages',
                    'width=800,height=600,top=100,left=100,resizable=yes,scrollbars=yes'
                  )"
                >
                  Ir para PostImages
                </button>
              </div>

            
            <label for="item-icon">√çcone (URL ou caminho):</label>
            <input type="text" id="item-icon" placeholder="Caminho do √≠cone">
            </fieldset>
            <br>
            
            <label for="item-damage">Dano:</label>
            <input type="text" id="item-damage" placeholder="Dano">
            
            <label for="item-description">Descri√ß√£o:</label>
            <textarea id="item-description" placeholder="Descri√ß√£o do item"></textarea>
            
            <label for="item-peso">Peso:</label>
            <input type="number" id="item-peso" placeholder="Peso">
            
            <label for="item-quantity">Quantidade:</label>
            <input type="number" id="item-quantity" placeholder="Quantidade">
            
            <label for="item-single-use">Item de Uso √önico:</label><br>
            <input type="checkbox" id="item-single-use">

            <div class="modal-buttons">
                <button id="submit-item">Adicionar</button>
                <button id="cancel-item">Cancelar</button>
            </div>
            </div>
        </div>

        <!-- Modal para exibir detalhes do item -->
        <div id="item-details-modal" class="modal" style="display: none;">
            <div class="modal-content">
            <h3 id="detail-item-name">Nome do Item</h3>
            <img id="detail-item-icon" src="" alt="√çcone do Item" class="item-icon">
            <p><strong>Dano:</strong> <span id="detail-item-damage"></span></p>
            <p><strong>Descri√ß√£o:</strong> <span id="detail-item-description"></span></p>
            <p><strong>Peso:</strong> <span id="detail-item-peso"></span></p>
            <p><strong>Quantidade:</strong> <span id="detail-item-quantity"></span></p>
            <div class="modal-buttons">
                <button id="use-item-button">Usar</button>
                <button id="close-details-button">Fechar</button>
            </div>
            </div>
        </div>

        
        <!-- Actions Section with Subtabs -->
        <div id="actions" class="content">
            <div class="subtabs">
                <div class="subtab active" onclick="openSubtab('actions', 'acoes')">A√ß√µes</div>
                <div class="subtab" onclick="openSubtab('actions', 'ajustes')">Ajustes</div>
                <div class="subtab" onclick="openSubtab('actions', 'testes')">Testes</div>
            </div>
            <div id="acoes" class="subcontent active">
                <!-- Pr√©-visualiza√ß√£o do Invent√°rio -->
                <div id="inventory-preview" class="inventory-preview">
                    <h3>Selecione o item para atacar</h3>
                    <div class="slider-container">
                    <!-- Os itens do invent√°rio ser√£o inseridos dinamicamente aqui -->
                    </div>
                </div>
                <h2>Atacar</h2>
                <label for="vantagens-ataque">N√∫mero de Vantagens:</label>
                <input type="number" id="vantagens-ataque" value="0">
                <br>
                <label for="modificador-ataque">Modificador:</label>
                <input type="number" id="modificador-ataque" value="0">
                <br>
                <button onclick="executarAtaque()">Executar Ataque</button>

                <h2>Atirar</h2>
                <label for="vantagens-tiro">N√∫mero de Vantagens:</label>
                <input type="number" id="vantagens-tiro" value="0">
                <br>
                <label for="modificador-tiro">Modificador:</label>
                <input type="number" id="modificador-tiro" value="0">
                <br>
                <button onclick="executarTiro()">Executar Tiro</button>

                <h2>Defender</h2>
                <label for="vantagens-defesa">N√∫mero de Vantagens:</label>
                <input type="number" id="vantagens-defesa" value="0">
                <br>
                <label for="modificador-defesa">Modificador:</label>
                <input type="number" id="modificador-defesa" value="0">
                <br>
                <button onclick="executarDefesa()">Executar Defesa</button>
                <!-- <div id="check-sanidade">
                          <input type="checkbox" id="checkSanidade" checked>
                          <label for="checkSanidade">Sanidade Total</label>  </div> -->    
                <h2>Esquivar</h2>
                <label for="vantagens-esquiva">N√∫mero de Vantagens:</label>
                <input type="number" id="vantagens-esquiva" value="0">
                <br>
                <label for="modificador-esquiva">Modificador:</label>
                <input type="number" id="modificador-esquiva" value="0">
                <br>
                <button onclick="executarEsquiva()">Executar Esquiva</button>
                
                <h2>Contra-Atacar</h2>
                <label for="vantagens-contraataque">N√∫mero de Vantagens:</label>
                <input type="number" id="vantagens-contraataque" value="0">
                <br>
                <label for="modificador-contraataque">Modificador:</label>
                <input type="number" id="modificador-contraataque" value="0">
                <br>
                <button onclick="executarContraAtaque()">Executar Contra-Ataque</button>
            </div>
            <div id="ajustes" class="subcontent">
                <h2>Ajuste Energia:</h2>
                <input type="text" id="ajuste-energia" />
                <button onclick="ajustarEnergia(1)">Adicionar Energia</button>
                <button onclick="ajustarEnergia(-1)">Reduzir Energia</button>
                <h2>Ajuste Vida:</h2>
                <input type="text" id="ajuste-vida" />
                <button onclick="ajustarVida(1)">Adicionar Vida</button>
                <button onclick="ajustarVida(-1)">Reduzir Vida</button>
                <h2>Ajuste Sanidade:</h2>
                <input type="text" id="ajuste-sanidade" />
                <button onclick="ajustarSanidade(1)">Adicionar Sanidade</button>
                <button onclick="ajustarSanidade(-1)">Reduzir Sanidade</button>
                <!-- <h2>Ajuste Defesa:</h2>
                <input type="text" id="ajuste-defesa" />
                <button onclick="ajustarDefesa(1)">Adicionar Defesa</button>
                <button onclick="ajustarDefesa(-1)">Reduzir Defesa</button>
                Outros elementos da interface, se houver
                <h2>Sair:</h2>
                <button onclick="sairAjustes()">Sair dos Ajustes</button> -->
            </div>
            <div id="testes" class="subcontent">
                <!-- Pr√©-visualiza√ß√£o do Invent√°rio -->
                <div id="inventory-preview-testes" class="inventory-preview">
                    <h3>Selecione o item para atacar</h3>
                    <div class="slider-container">
                        <!-- Os itens do invent√°rio ser√£o inseridos dinamicamente aqui -->
                    </div>
                </div>
                <label for="atributo">Atributo:</label>
                <select id="atributoSelect1">
                        <option value="atbrnull">Null</option>
                        <option value="atbr1"></option>
                        <option value="atbr2"></option>
                        <option value="atbr3"></option>
                    <!-- Adicione mais op√ß√µes conforme necess√°rio -->
                </select><br><br>
        
                <label for="pericia">Per√≠cia:</label>
                <select id="periciaSelect1">
                  <option value="null">Null</option>
                  <option value="reflexo">Reflexo</option>
                  <option value="medicina">Medicina</option>
                  <option value="manifestacao">Manifesta√ß√£o</option>
                  <option value="fortitude">Fortitude</option>
                  <option value="luta">Luta</option>
                  <option value="vontade">Vontade</option>
                  <option value="pontaria">Pontaria</option>
                  <option value="calamidade">Calamidade</option>
                  <option value="percepcao">Percep√ß√£o</option>
                  <option value="investigacao">Investiga√ß√£o</option>
                  <option value="sorte">Sorte</option>
                  <option value="furtividade">Furtividade</option>
                  <option value="inteligencia">Intelig√™ncia</option>
                  <option value="diplomacia">Diplomacia</option>
                  <option value="pilotagem">Pilotagem</option>
                  <option value="iniciativa">Iniciativa</option>
                </select><br><br>

        
                <label for="vantagens">Vantagens:</label>
                <input type="number" id="vantagensInput1" value="0"><br><br>
            
                <label for="modificador">Modificador:</label>
                <input type="number" id="modificadorInput1" value="0"><br><br>
            
                <button onclick="executarAcao()">Executar A√ß√£o</button>
            </div>
        </div> 
      <div id="bottom-toggles">
        <button id="togglechat1"class="toggle-bot">Chat</button>
        <button id="toggleplayer1"class="toggle-bot">Player</i></button>
        <button id="toggleselection1"class="toggle-bot">Menu</i></button>
        <button id="toggleinfo1"class="toggle-bot">Infos</i></button>
      </div>
    </div>                                               
        <script src="https://apis.google.com/js/api.js" defer></script>
        <script>
            function handleGisLoaded() {
                    if (typeof gisLoaded === 'function') {
                        gisLoaded();
                    } else {
                        console.error("Fun√ß√£o gisLoaded n√£o carregada corretamente.");
                    }
            }
        </script>
        <script src="google.js?v=1.0.11" defer></script>
        <script src="youtube.js?v=1.0.11" defer></script>
        <script src="https://accounts.google.com/gsi/client" async defer onload="handleGisLoaded()"></script>        
        <script src="script.js?v=1.0.9" defer></script>  <!-- Carregar script.js antes de chat.js -->
        <script src="map.js?v=1.0.2" defer></script>
        <script src="inventario.js?=1.0.2" defer></script> 
        <script src="https://cdn.jsdelivr.net/npm/markdown-it/dist/markdown-it.min.js"></script>  
    </body>
  </html>
